import{d as G,l as w,h as R,A as K,W as f,f as n,o as a,a as t,g as v,b as m,e as y,u as c,j as u,v as b,k as C,F as U,r as V,t as l,i as T,n as q,c as W,H as X}from"./app-B5KpPDY2.js";import{P as H}from"./plus-UaQxqC04.js";import{R as J}from"./rotate-ccw-DomgZaBA.js";import{c as N}from"./createLucideIcon-DVE_rcBS.js";import{X as Q}from"./x-DJ5V0z_z.js";import{P as Y}from"./pen-uh9F7_6t.js";import{a as Z,U as _}from"./user-x-B7-RTMet.js";import{_ as ee}from"./_plugin-vue_export-helper-DlAUqK2U.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S=N("ArrowUpDownIcon",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=N("KeyRoundIcon",[["path",{d:"M2.586 17.414A2 2 0 0 0 2 18.828V21a1 1 0 0 0 1 1h3a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h1a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h.172a2 2 0 0 0 1.414-.586l.814-.814a6.5 6.5 0 1 0-4-4z",key:"1s6t7t"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]]),se={class:"space-y-6"},oe={class:"flex justify-between items-center"},le={class:"card p-4"},re={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},ae=["value"],ne={class:"flex items-end"},ie={class:"card overflow-hidden"},de={class:"overflow-x-auto"},ue={class:"table"},ve={class:"font-mono"},pe={class:"font-medium"},ce={class:"text-center"},me={class:"flex justify-center space-x-2"},be=["onClick"],ge=["onClick","title"],fe=["onClick"],ye={key:0,class:"border-t p-4"},xe={class:"flex justify-between items-center"},ke={class:"text-sm text-muted-foreground"},we={class:"flex space-x-2"},Ce=["onClick"],Ue={class:"modal-header"},Ve={class:"text-xl font-bold"},qe={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ae=["disabled"],Ie={key:0,class:"text-sm text-destructive mt-1"},Se={key:0,class:"text-sm text-destructive mt-1"},Ee={key:0,class:"text-sm text-destructive mt-1"},Re={key:0,class:"text-sm text-destructive mt-1"},Te={key:0,class:"text-sm text-destructive mt-1"},Ne={key:0,class:"text-sm text-destructive mt-1"},Me=["value"],$e={key:0,class:"text-sm text-destructive mt-1"},De={key:0,class:"md:col-span-2"},je={key:0,class:"text-sm text-destructive mt-1"},Pe={class:"flex justify-end space-x-2 pt-4 border-t"},Be=["disabled"],Fe=G({__name:"Index",props:{usuarios:{},roles:{}},setup(M){const E=M,A=w(!1),p=w(null),x=w(!1),i=w({}),d=R({search:"",rol:"",activo:"",sort:"created_at",direction:"desc"}),r=R({registro:"",nombre:"",apellido:"",carnet:"",email:"",telefono:"",rol:"",activo:!0,password:""});K(d,()=>{f.get(route("responsable.usuarios"),d,{preserveState:!0,preserveScroll:!0})},{deep:!0});const $=()=>{Object.assign(d,{search:"",tipo:"",activo:"",sort:"created_at",direction:"desc"})},I=o=>{d.sort===o?d.direction=d.direction==="asc"?"desc":"asc":(d.sort=o,d.direction="asc")},D=o=>{f.get(route("responsable.usuarios"),{...d,page:o})},j=()=>{const o=[],e=E.usuarios.current_page,s=E.usuarios.last_page;for(let g=Math.max(1,e-2);g<=Math.min(s,e+2);g++)o.push(g);return o},P=o=>({RESPONSABLE:"badge-destructive",ADMINISTRATIVO:"badge-warning",TUTOR:"badge-primary"})[o]||"badge-secondary",B=o=>new Date(o).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric"}),F=()=>{Object.assign(r,{registro:"",nombre:"",apellido:"",carnet:"",email:"",telefono:"",rol:"",activo:!0,password:""}),i.value={}},L=o=>{p.value=o,Object.assign(r,{registro:o.registro,nombre:o.nombre,apellido:o.apellido,carnet:o.carnet,email:o.email,telefono:o.telefono||"",rol:o.rol,activo:o.activo,password:""})},k=()=>{A.value=!1,p.value=null,F()},O=()=>{x.value=!0,i.value={};const o=p.value?route("responsable.usuarios.update",p.value.id):route("responsable.usuarios.store"),e=p.value?"put":"post";f[e](o,r,{onSuccess:()=>{k()},onError:s=>{i.value=s},onFinish:()=>{x.value=!1}})},h=o=>{confirm(`¿Estás seguro de ${o.activo?"desactivar":"activar"} este usuario?`)&&f.put(route("responsable.usuarios.toggle-status",o.id),{},{preserveScroll:!0})},z=o=>{confirm(`¿Estás seguro de restablecer la contraseña de ${o.nombre} ${o.apellido}?`)&&f.post(route("responsable.usuarios.reset-password",o.id),{},{preserveScroll:!0})};return(o,e)=>(a(),n("div",se,[t("div",oe,[e[18]||(e[18]=t("div",null,[t("h1",{class:"text-2xl font-bold"},"Gestión de Usuarios"),t("p",{class:"text-muted-foreground"},"Administrar usuarios del sistema CICIT")],-1)),t("button",{onClick:e[0]||(e[0]=s=>A.value=!0),class:"btn-primary"},[m(c(H),{class:"w-4 h-4 mr-2"}),e[17]||(e[17]=y(" Nuevo Usuario "))])]),t("div",le,[t("div",re,[t("div",null,[e[19]||(e[19]=t("label",{class:"label"},"Buscar",-1)),u(t("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>d.search=s),type:"text",placeholder:"Nombre, registro o cédula...",class:"input"},null,512),[[b,d.search]])]),t("div",null,[e[21]||(e[21]=t("label",{class:"label"},"Tipo",-1)),u(t("select",{"onUpdate:modelValue":e[2]||(e[2]=s=>d.rol=s),class:"input"},[e[20]||(e[20]=t("option",{value:""},"Todos",-1)),(a(!0),n(U,null,V(o.roles,s=>(a(),n("option",{key:s,value:s},l(s),9,ae))),128))],512),[[C,d.rol]])]),t("div",null,[e[23]||(e[23]=t("label",{class:"label"},"Estado",-1)),u(t("select",{"onUpdate:modelValue":e[3]||(e[3]=s=>d.activo=s),class:"input"},e[22]||(e[22]=[t("option",{value:""},"Todos",-1),t("option",{value:"1"},"Activos",-1),t("option",{value:"0"},"Inactivos",-1)]),512),[[C,d.activo]])]),t("div",ne,[t("button",{onClick:$,class:"btn-secondary w-full"},[m(c(J),{class:"w-4 h-4 mr-2"}),e[24]||(e[24]=y(" Limpiar "))])])])]),t("div",ie,[t("div",de,[t("table",ue,[t("thead",null,[t("tr",null,[t("th",{onClick:e[4]||(e[4]=s=>I("registro")),class:"cursor-pointer hover:bg-muted/50"},[e[25]||(e[25]=y(" Registro ")),m(c(S),{class:"w-4 h-4 inline ml-1"})]),t("th",{onClick:e[5]||(e[5]=s=>I("nombre")),class:"cursor-pointer hover:bg-muted/50"},[e[26]||(e[26]=y(" Nombre Completo ")),m(c(S),{class:"w-4 h-4 inline ml-1"})]),e[28]||(e[28]=t("th",null,"Carnet",-1)),e[29]||(e[29]=t("th",null,"Email",-1)),e[30]||(e[30]=t("th",null,"Teléfono",-1)),e[31]||(e[31]=t("th",null,"Rol",-1)),e[32]||(e[32]=t("th",null,"Estado",-1)),t("th",{onClick:e[6]||(e[6]=s=>I("created_at")),class:"cursor-pointer hover:bg-muted/50"},[e[27]||(e[27]=y(" Fecha Registro ")),m(c(S),{class:"w-4 h-4 inline ml-1"})]),e[33]||(e[33]=t("th",{class:"text-center"},"Acciones",-1))])]),t("tbody",null,[(a(!0),n(U,null,V(o.usuarios.data,s=>(a(),n("tr",{key:s.id},[t("td",ve,l(s.registro),1),t("td",pe,l(s.nombre)+" "+l(s.apellido),1),t("td",null,l(s.carnet),1),t("td",null,l(s.email),1),t("td",null,l(s.telefono||"-"),1),t("td",null,[t("span",{class:q(["badge",P(s.rol)])},l(s.rol),3)]),t("td",null,[t("span",{class:q(["badge",s.activo?"badge-success":"badge-destructive"])},l(s.activo?"Activo":"Inactivo"),3)]),t("td",null,l(B(s.created_at)),1),t("td",ce,[t("div",me,[t("button",{onClick:g=>L(s),class:"btn-sm btn-secondary",title:"Editar"},[m(c(Y),{class:"w-4 h-4"})],8,be),t("button",{onClick:g=>h(s),class:q(["btn-sm",s.activo?"btn-destructive":"btn-success"]),title:s.activo?"Desactivar":"Activar"},[(a(),W(X(s.activo?c(Z):c(_)),{class:"w-4 h-4"}))],10,ge),t("button",{onClick:g=>z(s),class:"btn-sm btn-warning",title:"Restablecer contraseña"},[m(c(te),{class:"w-4 h-4"})],8,fe)])])]))),128))])])]),o.usuarios.last_page>1?(a(),n("div",ye,[t("div",xe,[t("p",ke," Mostrando "+l(o.usuarios.from)+" a "+l(o.usuarios.to)+" de "+l(o.usuarios.total)+" usuarios ",1),t("div",we,[(a(!0),n(U,null,V(j(),s=>(a(),n("button",{key:s,onClick:g=>D(s),class:q(["btn-sm",s===o.usuarios.current_page?"btn-primary":"btn-secondary"])},l(s),11,Ce))),128))])])])):v("",!0)]),A.value||p.value?(a(),n("div",{key:0,class:"modal-overlay",onClick:k},[t("div",{class:"modal-content",onClick:e[16]||(e[16]=T(()=>{},["stop"]))},[t("div",Ue,[t("h2",Ve,l(p.value?"Editar Usuario":"Nuevo Usuario"),1),t("button",{onClick:k,class:"text-muted-foreground hover:text-foreground"},[m(c(Q),{class:"w-5 h-5"})])]),t("form",{onSubmit:T(O,["prevent"]),class:"space-y-4"},[t("div",qe,[t("div",null,[e[34]||(e[34]=t("label",{class:"label required"},"Registro",-1)),u(t("input",{"onUpdate:modelValue":e[7]||(e[7]=s=>r.registro=s),type:"text",class:"input",disabled:!!p.value,required:""},null,8,Ae),[[b,r.registro]]),i.value.registro?(a(),n("div",Ie,l(i.value.registro),1)):v("",!0)]),t("div",null,[e[35]||(e[35]=t("label",{class:"label required"},"Nombre",-1)),u(t("input",{"onUpdate:modelValue":e[8]||(e[8]=s=>r.nombre=s),type:"text",class:"input",required:""},null,512),[[b,r.nombre]]),i.value.nombre?(a(),n("div",Se,l(i.value.nombre),1)):v("",!0)]),t("div",null,[e[36]||(e[36]=t("label",{class:"label required"},"Apellido",-1)),u(t("input",{"onUpdate:modelValue":e[9]||(e[9]=s=>r.apellido=s),type:"text",class:"input",required:""},null,512),[[b,r.apellido]]),i.value.apellido?(a(),n("div",Ee,l(i.value.apellido),1)):v("",!0)]),t("div",null,[e[37]||(e[37]=t("label",{class:"label required"},"Carnet",-1)),u(t("input",{"onUpdate:modelValue":e[10]||(e[10]=s=>r.carnet=s),type:"text",class:"input",required:""},null,512),[[b,r.carnet]]),i.value.carnet?(a(),n("div",Re,l(i.value.carnet),1)):v("",!0)]),t("div",null,[e[38]||(e[38]=t("label",{class:"label required"},"Email",-1)),u(t("input",{"onUpdate:modelValue":e[11]||(e[11]=s=>r.email=s),type:"email",class:"input",required:""},null,512),[[b,r.email]]),i.value.email?(a(),n("div",Te,l(i.value.email),1)):v("",!0)]),t("div",null,[e[39]||(e[39]=t("label",{class:"label"},"Teléfono",-1)),u(t("input",{"onUpdate:modelValue":e[12]||(e[12]=s=>r.telefono=s),type:"text",class:"input"},null,512),[[b,r.telefono]]),i.value.telefono?(a(),n("div",Ne,l(i.value.telefono),1)):v("",!0)]),t("div",null,[e[41]||(e[41]=t("label",{class:"label required"},"Rol",-1)),u(t("select",{"onUpdate:modelValue":e[13]||(e[13]=s=>r.rol=s),class:"input",required:""},[e[40]||(e[40]=t("option",{value:""},"Seleccionar rol...",-1)),(a(!0),n(U,null,V(o.roles,s=>(a(),n("option",{key:s,value:s},l(s),9,Me))),128))],512),[[C,r.rol]]),i.value.rol?(a(),n("div",$e,l(i.value.rol),1)):v("",!0)]),t("div",null,[e[43]||(e[43]=t("label",{class:"label"},"Estado",-1)),u(t("select",{"onUpdate:modelValue":e[14]||(e[14]=s=>r.activo=s),class:"input"},e[42]||(e[42]=[t("option",{value:!0},"Activo",-1),t("option",{value:!1},"Inactivo",-1)]),512),[[C,r.activo]])]),p.value?v("",!0):(a(),n("div",De,[e[44]||(e[44]=t("label",{class:"label required"},"Contraseña",-1)),u(t("input",{"onUpdate:modelValue":e[15]||(e[15]=s=>r.password=s),type:"password",class:"input",placeholder:"Ingrese la contraseña para el usuario",required:"",minlength:"8"},null,512),[[b,r.password]]),i.value.password?(a(),n("div",je,l(i.value.password),1)):v("",!0),e[45]||(e[45]=t("p",{class:"text-sm text-muted-foreground mt-1"}," La contraseña debe tener al menos 8 caracteres ",-1))]))]),t("div",Pe,[t("button",{type:"button",onClick:k,class:"btn-secondary"}," Cancelar "),t("button",{type:"submit",class:"btn-primary",disabled:x.value},l(x.value?"Guardando...":p.value?"Actualizar":"Crear"),9,Be)])],32)])])):v("",!0)]))}}),He=ee(Fe,[["__scopeId","data-v-a25fb05d"]]);export{He as default};
