import{d as K,z as M,l as h,h as W,C as J,f as l,o as d,n as v,a as e,b as n,g as b,e as w,u as p,w as x,j as k,v as E,k as Q,F as Y,r as Z,t as i,i as ee,K as te,c as ae,H as re}from"./app-C3F20lhx.js";import{_ as A,a as L}from"./CardContent.vue_vue_type_script_setup_true_lang-guNwIqcz.js";import{_ as se,a as oe,b as ie,c as ne,d as de}from"./DialogTitle.vue_vue_type_script_setup_true_lang-B7XPigkC.js";import{P as V}from"./plus-CL-FAp7L.js";import{R as le}from"./rotate-ccw-CvO0BBlV.js";import{P as ce}from"./pen-zU0GkAoJ.js";import{X as P}from"./x-CodF7nIL.js";import{c as R}from"./createLucideIcon-CofApReS.js";import{C as ue,a as me}from"./circle-x-CDj3NtfD.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=R("InfoIcon",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=R("UsersIcon",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),be={class:"flex justify-between items-center"},xe={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},ge={class:"flex items-end"},ye={class:"overflow-x-auto"},he={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},ve={class:"bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-700"},ke={class:"px-6 py-4 whitespace-nowrap"},_e={class:"text-sm font-medium text-gray-900 dark:text-white"},we={key:0,class:"text-sm text-gray-500 dark:text-gray-400"},Ce={class:"px-6 py-4 whitespace-nowrap"},Ee={class:"px-6 py-4 whitespace-nowrap"},Fe={class:"px-6 py-4 whitespace-nowrap"},Me={class:"px-6 py-4 whitespace-nowrap"},Ne={class:"text-sm text-gray-900 dark:text-white"},Ge={key:0,class:"text-xs text-gray-500 dark:text-gray-400 ml-1"},De={class:"px-6 py-4 whitespace-nowrap"},qe={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},Ie={class:"flex items-center justify-end space-x-2"},Ue=["onClick"],Se=["onClick"],Te={key:0,class:"text-center py-12"},$e={class:"mt-1 text-sm text-gray-500 dark:text-gray-400"},je={key:0,class:"mt-6"},Ae=["disabled"],Le={key:0,class:"mt-1 text-sm text-red-600 dark:text-red-400"},Ve=["disabled"],Pe={key:0,class:"mt-1 text-sm text-red-600 dark:text-red-400"},Re=["disabled"],Xe={key:0,class:"mt-1 text-sm text-red-600 dark:text-red-400"},ze=["disabled"],Be={key:0,class:"mt-1 text-sm text-red-600 dark:text-red-400"},He={class:"flex items-center"},Oe=["disabled"],Ke={class:"flex justify-end space-x-3 pt-4"},We=["disabled"],Je=["disabled"],Qe={key:0,class:"flex items-center"},Ye={key:1},Ze={class:"flex items-center"},et={class:"text-sm font-medium"},ut=K({__name:"GestionesGestion",setup(tt){const X=M(()=>""),N=h([]),G=h(!0),C=h(!1),f=h(!1),c=h(!1),o=h({}),m=h({search:"",estado:""}),g=h({show:!1,type:"success",message:""}),r=W({id:null,nombre:"",descripcion:"",fecha_inicio:"",fecha_fin:"",activo:!0,reset(){this.id=null,this.nombre="",this.descripcion="",this.fecha_inicio="",this.fecha_fin="",this.activo=!0}}),D=M(()=>{let s=N.value;if(m.value.search){const t=m.value.search.toLowerCase();s=s.filter(a=>a.nombre.toLowerCase().includes(t)||a.descripcion&&a.descripcion.toLowerCase().includes(t))}if(m.value.estado){const t=m.value.estado;s=s.filter(a=>t==="actual"?a.estado_calculado==="En Curso":t==="futura"?a.estado_calculado==="Próxima":t==="pasada"?a.estado_calculado==="Finalizada":!0)}return s}),q=M(()=>m.value.search||m.value.estado),F=async()=>{var s;try{G.value=!0;const t=await fetch("/responsable/gestiones",{headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}});if(t.ok){const a=await t.json();N.value=((s=a.gestiones)==null?void 0:s.data)||[]}else y("Error al cargar las gestiones","error")}catch{y("Error al cargar las gestiones","error")}finally{G.value=!1}},I=()=>{f.value=!1,r.reset(),o.value={},C.value=!0},z=s=>{f.value=!0,r.id=s.id,r.nombre=s.nombre,r.descripcion=s.descripcion||"",r.fecha_inicio=T(s.fecha_inicio),r.fecha_fin=T(s.fecha_fin),r.activo=s.activo,o.value={},C.value=!0},U=()=>{C.value=!1,r.reset(),o.value={}},B=async()=>{var s;if(!c.value)try{c.value=!0,o.value={};const t={nombre:r.nombre,descripcion:r.descripcion||"",fecha_inicio:r.fecha_inicio,fecha_fin:r.fecha_fin,activo:r.activo};f.value&&(t._method="PUT"),console.log("Enviando datos:",t),console.log("form.activo tipo:",typeof r.activo,"valor:",r.activo);const a=f.value?`/responsable/gestiones/${r.id}`:"/responsable/gestiones";console.log("form.id:",r.id),console.log("isEditing:",f.value),console.log("form data:",{nombre:r.nombre,descripcion:r.descripcion,fecha_inicio:r.fecha_inicio,fecha_fin:r.fecha_fin,activo:r.activo});const u=new FormData;u.append("nombre",r.nombre),u.append("descripcion",r.descripcion||""),u.append("fecha_inicio",r.fecha_inicio),u.append("fecha_fin",r.fecha_fin),f.value&&u.append("_method","PUT"),console.log("FormData entries:");for(const _ of u.entries())console.log(_[0]+": "+_[1]);const j=await fetch(a,{method:"POST",headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":((s=document.querySelector("meta[name=csrf-token]"))==null?void 0:s.content)||""},body:u});if(j.ok)U(),F(),y(f.value?"Gestión actualizada exitosamente":"Gestión creada exitosamente","success");else{const _=await j.json();_.errors?o.value=_.errors:y(_.message||"Error al procesar la solicitud","error")}}catch{y("Error al procesar la solicitud","error")}finally{c.value=!1}},H=async s=>{var t;if(confirm(`¿Seguro que deseas eliminar la gestión "${s.nombre}"? Esta acción no se puede deshacer.`))try{c.value=!0;const a=await fetch(`/responsable/gestiones/${s.id}`,{method:"DELETE",headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":((t=document.querySelector("meta[name=csrf-token]"))==null?void 0:t.content)||""}});if(a.ok)y("Gestión eliminada exitosamente","success"),F();else{let u=null;try{u=await a.json()}catch{}y(u&&u.message||"Error al eliminar la gestión","error")}}catch{y("Error al eliminar la gestión","error")}finally{c.value=!1}},O=()=>{m.value={search:"",estado:""}},S=s=>s?new Date(s).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric"}):"N/A",T=s=>s?new Date(s).toISOString().split("T")[0]:"",y=(s,t="success")=>{g.value={show:!0,type:t,message:s},setTimeout(()=>{$()},5e3)},$=()=>{g.value.show=!1};return J(()=>{F()}),(s,t)=>(d(),l("div",{class:v(["space-y-4",X.value])},[e("div",be,[t[9]||(t[9]=e("div",null,[e("h2",{class:"text-xl font-bold text-gray-900 dark:text-white"},"Gestión de Gestiones"),e("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"Administrar gestiones académicas del sistema CICIT")],-1)),e("button",{onClick:I,class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-lg text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-all duration-200 shadow-md hover:shadow-lg transform hover:-translate-y-0.5"},[n(p(V),{class:"w-4 h-4 mr-2"}),t[8]||(t[8]=w(" Nueva Gestión "))])]),n(A,{class:"border border-gray-200 dark:border-gray-700"},{default:x(()=>[n(L,{class:"p-4"},{default:x(()=>[e("div",xe,[e("div",null,[t[10]||(t[10]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Buscar ",-1)),k(e("input",{"onUpdate:modelValue":t[0]||(t[0]=a=>m.value.search=a),type:"text",placeholder:"Nombre o año...",class:"block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary-500 focus:border-primary-500 text-sm dark:bg-gray-800 dark:text-white"},null,512),[[E,m.value.search]])]),e("div",null,[t[12]||(t[12]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Estado ",-1)),k(e("select",{"onUpdate:modelValue":t[1]||(t[1]=a=>m.value.estado=a),class:"block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 text-sm dark:bg-gray-800 dark:text-white"},t[11]||(t[11]=[e("option",{value:""},"Todas",-1),e("option",{value:"actual"},"Actual",-1),e("option",{value:"futura"},"Futura",-1),e("option",{value:"pasada"},"Finalizada",-1)]),512),[[Q,m.value.estado]])]),e("div",ge,[e("button",{onClick:O,class:"inline-flex items-center px-3 py-2 border border-gray-300 dark:border-gray-600 text-sm leading-4 font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 transition-colors duration-200"},[n(p(le),{class:"w-4 h-4 mr-2"}),t[13]||(t[13]=w(" Limpiar "))])])])]),_:1})]),_:1}),n(A,null,{default:x(()=>[n(L,{class:"p-0"},{default:x(()=>[e("div",ye,[e("table",he,[t[14]||(t[14]=e("thead",{class:"bg-gray-50 dark:bg-gray-800"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},"Nombre"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},"Estado"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},"Fecha Inicio"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},"Fecha Fin"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},"Cursos"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},"Activo"),e("th",{class:"px-6 py-3 relative"},[e("span",{class:"sr-only"},"Acciones")])])],-1)),e("tbody",ve,[(d(!0),l(Y,null,Z(D.value,a=>(d(),l("tr",{key:a.id,class:"hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors duration-200"},[e("td",ke,[e("div",null,[e("div",_e,i(a.nombre),1),a.descripcion?(d(),l("div",we,i(a.descripcion),1)):b("",!0)])]),e("td",Ce,[e("span",{class:v([{"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":a.estado_calculado==="En Curso","bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200":a.estado_calculado==="Próxima","bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200":a.estado_calculado==="Finalizada"},"inline-flex px-2 py-1 text-xs font-semibold rounded-full"])},i(a.estado_calculado||"Sin estado"),3)]),e("td",Ee,i(S(a.fecha_inicio)),1),e("td",Fe,i(S(a.fecha_fin)),1),e("td",Me,[e("span",Ne,i(a.cursos_count||0),1),a.cursos_activos_count?(d(),l("span",Ge,"("+i(a.cursos_activos_count)+" activos)",1)):b("",!0)]),e("td",De,[e("span",{class:v([a.activo?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200","inline-flex px-2 py-1 text-xs font-semibold rounded-full"])},i(a.activo?"Activo":"Inactivo"),3)]),e("td",qe,[e("div",Ie,[e("button",{onClick:u=>z(a),class:"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300 transition-colors duration-200 p-1 rounded-md hover:bg-blue-50 dark:hover:bg-blue-900/20",title:"Editar"},[n(p(ce),{class:"w-4 h-4"})],8,Ue),e("button",{onClick:u=>H(a),class:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300 transition-colors duration-200 p-1 rounded-md hover:bg-red-50 dark:hover:bg-red-900/20",title:"Eliminar"},[n(p(P),{class:"w-4 h-4"})],8,Se)])])]))),128))])]),D.value.length===0?(d(),l("div",Te,[n(p(pe),{class:"mx-auto h-12 w-12 text-gray-400"}),t[16]||(t[16]=e("h3",{class:"mt-2 text-sm font-medium text-gray-900 dark:text-white"},"No hay gestiones",-1)),e("p",$e,i(q.value?"No se encontraron resultados con los filtros aplicados.":"Comienza creando una nueva gestión."),1),q.value?b("",!0):(d(),l("div",je,[e("button",{onClick:I,class:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},[n(p(V),{class:"w-4 h-4 mr-2"}),t[15]||(t[15]=w(" Nueva Gestión "))])]))])):b("",!0)])]),_:1})]),_:1}),n(se,{open:C.value,"onUpdate:open":t[7]||(t[7]=a=>C.value=a)},{default:x(()=>[n(oe,{class:"sm:max-w-md"},{default:x(()=>[n(ie,null,{default:x(()=>[n(ne,null,{default:x(()=>[w(i(f.value?"Editar Gestión":"Nueva Gestión"),1)]),_:1}),n(de,null,{default:x(()=>[w(i(f.value?"Modifica los datos de la gestión.":"Completa los datos para crear una nueva gestión."),1)]),_:1})]),_:1}),e("form",{onSubmit:ee(B,["prevent"]),class:"space-y-4"},[e("div",null,[t[17]||(t[17]=e("label",{for:"nombre",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Nombre *",-1)),k(e("input",{id:"nombre","onUpdate:modelValue":t[2]||(t[2]=a=>r.nombre=a),type:"text",maxlength:"100",class:v(["mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-sm dark:bg-gray-800 dark:text-white",{"border-red-500":o.value.nombre}]),placeholder:"Ej: Gestión 2025-1",required:"",disabled:c.value},null,10,Ae),[[E,r.nombre]]),o.value.nombre?(d(),l("p",Le,i(o.value.nombre),1)):b("",!0)]),e("div",null,[t[18]||(t[18]=e("label",{for:"descripcion",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Descripción",-1)),k(e("textarea",{id:"descripcion","onUpdate:modelValue":t[3]||(t[3]=a=>r.descripcion=a),rows:"3",maxlength:"1000",class:v(["mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-sm dark:bg-gray-800 dark:text-white",{"border-red-500":o.value.descripcion}]),placeholder:"Descripción opcional de la gestión",disabled:c.value},null,10,Ve),[[E,r.descripcion]]),o.value.descripcion?(d(),l("p",Pe,i(o.value.descripcion),1)):b("",!0)]),e("div",null,[t[19]||(t[19]=e("label",{for:"fecha_inicio",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Fecha Inicio *",-1)),k(e("input",{id:"fecha_inicio","onUpdate:modelValue":t[4]||(t[4]=a=>r.fecha_inicio=a),type:"date",class:v(["mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-sm dark:bg-gray-800 dark:text-white",{"border-red-500":o.value.fecha_inicio}]),required:"",disabled:c.value},null,10,Re),[[E,r.fecha_inicio]]),o.value.fecha_inicio?(d(),l("p",Xe,i(o.value.fecha_inicio),1)):b("",!0)]),e("div",null,[t[20]||(t[20]=e("label",{for:"fecha_fin",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Fecha Fin *",-1)),k(e("input",{id:"fecha_fin","onUpdate:modelValue":t[5]||(t[5]=a=>r.fecha_fin=a),type:"date",class:v(["mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-sm dark:bg-gray-800 dark:text-white",{"border-red-500":o.value.fecha_fin}]),required:"",disabled:c.value},null,10,ze),[[E,r.fecha_fin]]),o.value.fecha_fin?(d(),l("p",Be,i(o.value.fecha_fin),1)):b("",!0)]),e("div",null,[e("label",He,[k(e("input",{"onUpdate:modelValue":t[6]||(t[6]=a=>r.activo=a),type:"checkbox",class:"rounded border-gray-300 text-blue-600 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50",disabled:c.value},null,8,Oe),[[te,r.activo]]),t[21]||(t[21]=e("span",{class:"ml-2 text-sm text-gray-700 dark:text-gray-300"},"Activo",-1))])]),e("div",Ke,[e("button",{type:"button",onClick:U,class:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",disabled:c.value},"Cancelar",8,We),e("button",{type:"submit",class:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",disabled:c.value},[c.value?(d(),l("span",Qe,t[22]||(t[22]=[e("div",{class:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"},null,-1),w(" Procesando... ")]))):(d(),l("span",Ye,i(f.value?"Actualizar":"Crear"),1))],8,Je)])],32)]),_:1})]),_:1},8,["open"]),g.value.show?(d(),l("div",{key:0,class:v(["fixed top-4 right-4 z-50 p-4 rounded-lg shadow-lg max-w-md transition-all duration-300 transform",g.value.type==="success"?"bg-green-100 border border-green-200 text-green-800 dark:bg-green-900 dark:border-green-700 dark:text-green-200":g.value.type==="error"?"bg-red-100 border border-red-200 text-red-800 dark:bg-red-900 dark:border-red-700 dark:text-red-200":"bg-blue-100 border border-blue-200 text-blue-800 dark:bg-blue-900 dark:border-blue-700 dark:text-blue-200"])},[e("div",Ze,[(d(),ae(re(g.value.type==="success"?p(ue):g.value.type==="error"?p(me):p(fe)),{class:"w-5 h-5 mr-2"})),e("p",et,i(g.value.message),1),e("button",{onClick:$,class:"ml-auto pl-3"},[n(p(P),{class:"w-4 h-4"})])])],2)):b("",!0)],2))}});export{fe as I,pe as U,ut as _};
