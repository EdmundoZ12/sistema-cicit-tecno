import{d as M,z as L,x as $,l as A,c as G,o as i,w as S,b as x,a as r,u as s,y as R,S as B,e as h,i as X,j as m,f as l,g,n as b,v as f,t as n,k as _,F as w,r as C,K as H}from"./app-B5KpPDY2.js";import{_ as K}from"./CICITLayout.vue_vue_type_script_setup_true_lang-ee6THyem.js";import{A as O}from"./arrow-left-9bXAorQ6.js";import{T as W}from"./trash-2-BcocUo8P.js";import{P as J}from"./plus-UaQxqC04.js";import"./createLucideIcon-DVE_rcBS.js";const Y={class:"py-6"},Q={class:"max-w-4xl mx-auto sm:px-6 lg:px-8"},Z={class:"mb-6"},ee={class:"flex items-center justify-between"},re={class:"bg-white dark:bg-gray-800 shadow-sm rounded-lg border border-gray-200 dark:border-gray-700"},oe={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},te={class:"md:col-span-2"},se={key:0,class:"mt-2 text-sm text-red-600"},ae={class:"md:col-span-2"},ie={key:0,class:"mt-2 text-sm text-red-600"},de={key:0,class:"mt-2 text-sm text-red-600"},le={key:0,class:"mt-2 text-sm text-red-600"},ne=["value"],ue={key:0,class:"mt-2 text-sm text-red-600"},ce=["value"],me={key:0,class:"mt-2 text-sm text-red-600"},ge={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},be={key:0,class:"mt-2 text-sm text-red-600"},pe=["min"],fe={key:0,class:"mt-2 text-sm text-red-600"},ye={class:"mt-1 text-xs text-gray-500"},xe={key:0,class:"mt-2"},ve=["src"],ke={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},he={key:0,class:"mt-2 text-sm text-red-600"},_e={key:0,class:"mt-2 text-sm text-red-600"},we={class:"flex items-center"},Ce={class:"space-y-4"},Se=["onUpdate:modelValue"],Pe=["value"],Ue=["onUpdate:modelValue"],qe={class:"flex items-end"},Ee=["onClick"],Te={key:0,class:"mt-2 text-sm text-red-600"},Ve={class:"flex justify-end space-x-3 pt-6 border-t border-gray-200 dark:border-gray-600"},De=["disabled"],Ae={key:0,class:"inline-flex items-center"},Be={key:1},Le=M({__name:"Edit",props:{curso:{},tutores:{},gestiones:{},tiposParticipante:{},errors:{}},setup(z){const u=z,t=L(()=>u.errors||{}),P=d=>{if(!d)return"";if(typeof d=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(d))return d;if(typeof d=="string"&&d.includes(" "))return d.split(" ")[0];try{const e=new Date(d);if(isNaN(e.getTime()))return"";const o=e.getFullYear(),y=String(e.getMonth()+1).padStart(2,"0"),c=String(e.getDate()).padStart(2,"0");return`${o}-${y}-${c}`}catch{return""}},a=$({nombre:u.curso.nombre,descripcion:u.curso.descripcion||"",duracion_horas:u.curso.duracion_horas,nivel:u.curso.nivel||"",logo_url:u.curso.logo_url||"",tutor_id:u.curso.tutor_id,gestion_id:u.curso.gestion_id,aula:u.curso.aula||"",cupos_totales:u.curso.cupos_totales,fecha_inicio:P(u.curso.fecha_inicio),fecha_fin:P(u.curso.fecha_fin),activo:u.curso.activo,precios:u.curso.precios.length>0?u.curso.precios.map(d=>({tipo_participante_id:d.tipo_participante_id,precio:d.precio})):[{tipo_participante_id:0,precio:0}]}),U=A(!1),p=A(),q=d=>{d.preventDefault(),window.location.href="/dashboard",localStorage.setItem("activeDashboardSection","cursos")},I=async d=>{var c,E,T;const e=(c=d.target.files)==null?void 0:c[0];if(!e)return;if(!["image/jpeg","image/jpg","image/png","image/webp"].includes(e.type)){alert("Por favor seleccione una imagen válida (JPEG, PNG, WEBP)"),p.value&&(p.value.value="");return}if(e.size>2*1024*1024){alert("La imagen no debe superar los 2MB"),p.value&&(p.value.value="");return}const y=new FormData;y.append("image",e);try{const k=((E=document.querySelector('meta[name="csrf-token"]'))==null?void 0:E.getAttribute("content"))||((T=document.querySelector('input[name="_token"]'))==null?void 0:T.getAttribute("value")),V={"X-Requested-With":"XMLHttpRequest",Accept:"application/json"};k&&(V["X-CSRF-TOKEN"]=k);const D=await fetch("/responsable/cursos/upload-image",{method:"POST",body:y,headers:V,credentials:"same-origin"}),v=await D.json();D.ok&&v.success?(a.logo_url=v.url,console.log("Imagen subida exitosamente:",v.url)):(console.error("Error response:",v),alert("Error al subir la imagen: "+(v.message||"Error desconocido")),p.value&&(p.value.value=""))}catch(k){console.error("Error uploading image:",k),alert("Error de conectividad al subir la imagen. Intente nuevamente."),p.value&&(p.value.value="")}},j=()=>{a.precios.push({tipo_participante_id:0,precio:0})},F=d=>{a.precios.splice(d,1)},N=()=>{a.put(route("responsable.cursos.update",u.curso.id),{onSuccess:()=>{alert("Curso actualizado exitosamente"),localStorage.setItem("activeDashboardSection","cursos"),window.location.href="/dashboard"},onError:()=>{alert("Error al actualizar el curso. Por favor verifique los datos.")}})};return(d,e)=>(i(),G(K,null,{default:S(()=>[x(s(R),{title:"Editar Curso"}),r("div",Y,[r("div",Q,[r("div",Z,[r("div",ee,[e[12]||(e[12]=r("div",null,[r("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white"},"Editar Curso"),r("p",{class:"mt-1 text-sm text-gray-600 dark:text-gray-400"}," Modifique la información del curso ")],-1)),x(s(B),{href:"/dashboard",class:"inline-flex items-center px-4 py-2 border border-gray-300 dark:border-gray-600 text-sm font-medium rounded-lg text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors duration-200",onClick:q},{default:S(()=>[x(s(O),{class:"w-4 h-4 mr-2"}),e[11]||(e[11]=h(" Volver "))]),_:1,__:[11]})])]),r("div",re,[r("form",{onSubmit:X(N,["prevent"]),class:"p-6 space-y-6"},[r("div",null,[e[22]||(e[22]=r("h3",{class:"text-lg font-medium text-gray-900 dark:text-white mb-4"},"Información Básica",-1)),r("div",oe,[r("div",te,[e[13]||(e[13]=r("label",{for:"nombre",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Nombre del Curso * ",-1)),m(r("input",{id:"nombre","onUpdate:modelValue":e[0]||(e[0]=o=>s(a).nombre=o),type:"text",required:"",class:b(["block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-sm dark:bg-gray-700 dark:text-white",{"border-red-300":t.value.nombre}])},null,2),[[f,s(a).nombre]]),t.value.nombre?(i(),l("div",se,n(t.value.nombre),1)):g("",!0)]),r("div",ae,[e[14]||(e[14]=r("label",{for:"descripcion",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Descripción ",-1)),m(r("textarea",{id:"descripcion","onUpdate:modelValue":e[1]||(e[1]=o=>s(a).descripcion=o),rows:"3",class:b(["block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-sm dark:bg-gray-700 dark:text-white",{"border-red-300":t.value.descripcion}])},null,2),[[f,s(a).descripcion]]),t.value.descripcion?(i(),l("div",ie,n(t.value.descripcion),1)):g("",!0)]),r("div",null,[e[15]||(e[15]=r("label",{for:"duracion_horas",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Duración (horas) * ",-1)),m(r("input",{id:"duracion_horas","onUpdate:modelValue":e[2]||(e[2]=o=>s(a).duracion_horas=o),type:"number",min:"1",required:"",class:b(["block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-sm dark:bg-gray-700 dark:text-white",{"border-red-300":t.value.duracion_horas}])},null,2),[[f,s(a).duracion_horas,void 0,{number:!0}]]),t.value.duracion_horas?(i(),l("div",de,n(t.value.duracion_horas),1)):g("",!0)]),r("div",null,[e[17]||(e[17]=r("label",{for:"nivel",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Nivel ",-1)),m(r("select",{id:"nivel","onUpdate:modelValue":e[3]||(e[3]=o=>s(a).nivel=o),class:b(["block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-sm dark:bg-gray-700 dark:text-white",{"border-red-300":t.value.nivel}])},e[16]||(e[16]=[r("option",{value:""},"Seleccionar nivel",-1),r("option",{value:"Básico"},"Básico",-1),r("option",{value:"Intermedio"},"Intermedio",-1),r("option",{value:"Avanzado"},"Avanzado",-1)]),2),[[_,s(a).nivel]]),t.value.nivel?(i(),l("div",le,n(t.value.nivel),1)):g("",!0)]),r("div",null,[e[19]||(e[19]=r("label",{for:"tutor_id",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Tutor * ",-1)),m(r("select",{id:"tutor_id","onUpdate:modelValue":e[4]||(e[4]=o=>s(a).tutor_id=o),required:"",class:b(["block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-sm dark:bg-gray-700 dark:text-white",{"border-red-300":t.value.tutor_id}])},[e[18]||(e[18]=r("option",{value:""},"Seleccionar tutor",-1)),(i(!0),l(w,null,C(d.tutores,o=>(i(),l("option",{key:o.id,value:o.id},n(o.nombre)+" "+n(o.apellido),9,ne))),128))],2),[[_,s(a).tutor_id]]),t.value.tutor_id?(i(),l("div",ue,n(t.value.tutor_id),1)):g("",!0)]),r("div",null,[e[21]||(e[21]=r("label",{for:"gestion_id",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Gestión * ",-1)),m(r("select",{id:"gestion_id","onUpdate:modelValue":e[5]||(e[5]=o=>s(a).gestion_id=o),required:"",class:b(["block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-sm dark:bg-gray-700 dark:text-white",{"border-red-300":t.value.gestion_id}])},[e[20]||(e[20]=r("option",{value:""},"Seleccionar gestión",-1)),(i(!0),l(w,null,C(d.gestiones,o=>(i(),l("option",{key:o.id,value:o.id},n(o.nombre),9,ce))),128))],2),[[_,s(a).gestion_id]]),t.value.gestion_id?(i(),l("div",me,n(t.value.gestion_id),1)):g("",!0)])])]),r("div",null,[e[26]||(e[26]=r("h3",{class:"text-lg font-medium text-gray-900 dark:text-white mb-4"},"Detalles del Curso",-1)),r("div",ge,[r("div",null,[e[23]||(e[23]=r("label",{for:"aula",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Aula ",-1)),m(r("input",{id:"aula","onUpdate:modelValue":e[6]||(e[6]=o=>s(a).aula=o),type:"text",class:b(["block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-sm dark:bg-gray-700 dark:text-white",{"border-red-300":t.value.aula}])},null,2),[[f,s(a).aula]]),t.value.aula?(i(),l("div",be,n(t.value.aula),1)):g("",!0)]),r("div",null,[e[24]||(e[24]=r("label",{for:"cupos_totales",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Cupos Totales * ",-1)),m(r("input",{id:"cupos_totales","onUpdate:modelValue":e[7]||(e[7]=o=>s(a).cupos_totales=o),type:"number",min:d.curso.cupos_ocupados||1,required:"",class:b(["block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-sm dark:bg-gray-700 dark:text-white",{"border-red-300":t.value.cupos_totales}])},null,10,pe),[[f,s(a).cupos_totales,void 0,{number:!0}]]),t.value.cupos_totales?(i(),l("div",fe,n(t.value.cupos_totales),1)):g("",!0),r("p",ye,"Cupos ocupados: "+n(d.curso.cupos_ocupados||0),1)]),r("div",null,[e[25]||(e[25]=r("label",{for:"logo_file",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Logo del Curso ",-1)),r("input",{id:"logo_file",ref_key:"logoInput",ref:p,type:"file",accept:"image/*",onChange:I,class:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-medium file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"},null,544),s(a).logo_url?(i(),l("div",xe,[r("img",{src:s(a).logo_url,alt:"Logo preview",class:"h-20 w-20 object-cover rounded-md"},null,8,ve)])):g("",!0)])])]),r("div",null,[e[29]||(e[29]=r("h3",{class:"text-lg font-medium text-gray-900 dark:text-white mb-4"},"Fechas",-1)),r("div",ke,[r("div",null,[e[27]||(e[27]=r("label",{for:"fecha_inicio",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Fecha de Inicio * ",-1)),m(r("input",{id:"fecha_inicio","onUpdate:modelValue":e[8]||(e[8]=o=>s(a).fecha_inicio=o),type:"date",required:"",class:b(["block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-sm dark:bg-gray-700 dark:text-white",{"border-red-300":t.value.fecha_inicio}])},null,2),[[f,s(a).fecha_inicio]]),t.value.fecha_inicio?(i(),l("div",he,n(t.value.fecha_inicio),1)):g("",!0)]),r("div",null,[e[28]||(e[28]=r("label",{for:"fecha_fin",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Fecha de Fin * ",-1)),m(r("input",{id:"fecha_fin","onUpdate:modelValue":e[9]||(e[9]=o=>s(a).fecha_fin=o),type:"date",required:"",class:b(["block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-sm dark:bg-gray-700 dark:text-white",{"border-red-300":t.value.fecha_fin}])},null,2),[[f,s(a).fecha_fin]]),t.value.fecha_fin?(i(),l("div",_e,n(t.value.fecha_fin),1)):g("",!0)])])]),r("div",null,[e[31]||(e[31]=r("h3",{class:"text-lg font-medium text-gray-900 dark:text-white mb-4"},"Estado",-1)),r("div",we,[m(r("input",{id:"activo","onUpdate:modelValue":e[10]||(e[10]=o=>s(a).activo=o),type:"checkbox",class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"},null,512),[[H,s(a).activo]]),e[30]||(e[30]=r("label",{for:"activo",class:"ml-2 block text-sm text-gray-900 dark:text-white"}," Curso activo ",-1))])]),r("div",null,[e[36]||(e[36]=r("h3",{class:"text-lg font-medium text-gray-900 dark:text-white mb-4"},"Precios por Tipo de Participante",-1)),r("div",Ce,[(i(!0),l(w,null,C(s(a).precios,(o,y)=>(i(),l("div",{key:y,class:"grid grid-cols-1 md:grid-cols-3 gap-4 p-4 border border-gray-200 dark:border-gray-600 rounded-md"},[r("div",null,[e[33]||(e[33]=r("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Tipo de Participante ",-1)),m(r("select",{"onUpdate:modelValue":c=>o.tipo_participante_id=c,required:"",class:"block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-sm dark:bg-gray-700 dark:text-white"},[e[32]||(e[32]=r("option",{value:""},"Seleccionar tipo",-1)),(i(!0),l(w,null,C(d.tiposParticipante,c=>(i(),l("option",{key:c.id,value:c.id},n(c.codigo)+" - "+n(c.descripcion),9,Pe))),128))],8,Se),[[_,o.tipo_participante_id]])]),r("div",null,[e[34]||(e[34]=r("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Precio (Bs.) ",-1)),m(r("input",{"onUpdate:modelValue":c=>o.precio=c,type:"number",min:"0",step:"0.01",required:"",class:"block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-sm dark:bg-gray-700 dark:text-white"},null,8,Ue),[[f,o.precio,void 0,{number:!0}]])]),r("div",qe,[s(a).precios.length>1?(i(),l("button",{key:0,type:"button",onClick:c=>F(y),class:"inline-flex items-center px-3 py-2 border border-red-300 text-sm leading-4 font-medium rounded-md text-red-700 bg-white hover:bg-red-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500"},[x(s(W),{class:"w-4 h-4"})],8,Ee)):g("",!0)])]))),128)),r("button",{type:"button",onClick:j,class:"inline-flex items-center px-4 py-2 border border-gray-300 dark:border-gray-600 text-sm font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},[x(s(J),{class:"w-4 h-4 mr-2"}),e[35]||(e[35]=h(" Agregar Precio "))])]),t.value.precios?(i(),l("div",Te,n(t.value.precios),1)):g("",!0)]),r("div",Ve,[x(s(B),{href:"/dashboard",class:"inline-flex justify-center px-4 py-2 border border-gray-300 dark:border-gray-600 text-sm font-medium rounded-md text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",onClick:q},{default:S(()=>e[37]||(e[37]=[h(" Cancelar ")])),_:1,__:[37]}),r("button",{type:"submit",disabled:U.value,class:"inline-flex justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50"},[U.value?(i(),l("span",Ae,e[38]||(e[38]=[r("svg",{class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[r("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),r("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),h(" Actualizando... ")]))):(i(),l("span",Be,"Actualizar Curso"))],8,De)])],32)])])])]),_:1}))}});export{Le as default};
